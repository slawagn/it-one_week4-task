DROP TABLE IF EXISTS "orders" CASCADE;
CREATE TABLE "orders" (
	"order_id" INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	"order_code" VARCHAR(255) NOT NULL,
	"comment" VARCHAR(255),
	"created_at" DATE NOT NULL
) PARTITION BY RANGE (created_at);

CREATE TABLE orders_y2023 PARTITION OF orders
  FOR VALUES FROM ('2023-01-01') TO ('2024-01-01');

CREATE TABLE orders_y2024 PARTITION OF orders
  FOR VALUES FROM ('2024-01-01') TO ('2025-01-01');
DROP INDEX IF EXISTS IX_orders_y2024_order_id;
CREATE INDEX IX_orders_y2024_order_id ON orders_y2024 (order_id);

CREATE TABLE orders_y2025 PARTITION OF orders
  FOR VALUES FROM ('2025-01-01') TO ('2026-01-01');
DROP INDEX IF EXISTS IX_orders_y2025_order_id;
CREATE INDEX IX_orders_y2025_order_id ON orders_y2025 (order_id);
